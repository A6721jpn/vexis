# リリースノート: VEXIS-CAE

本ドキュメントでは、自動解析ワークフローシステム「VEXIS-CAE」の各バージョンの変遷と主要な変更点を、開発の軌跡とともに詳細に記録しています。

---

## Version 1.3.0 (リファクタリングとUI改善) - Current
**開発日**: 2026-01-06
コードベースの整理と結果表示機能の大幅な改善を行ったバージョンです。

- **リファクタリング:**
    - **共通ジオメトリユーティリティの統合**: バウンディングボックス計算、境界面抽出、KDTreeクエリなどを `src/utils/geometry.py` に一元化。
    - **SetReconstructor の戦略パターン化**: 複雑な if-else ロジックを `ReconstructionStrategy` 抽象クラスと具象実装 (`RelativeBoundsStrategy`, `ProximityStrategy`, `GeometricRuleStrategy`) に分離。
    - **GUIユーティリティの分離**: `load_icon` 関数を `src/gui/utils.py` に抽出し、SVGカラー置換とキャッシュ機能を共通化。

- **バグ修正:**
    - **接触面再構築エラー**: Hex20要素の境界面抽出で発生していた `ambiguous truth value` エラーを修正。これによりサーフェスが orphaned として削除される問題を解決。

- **UI改善:**
    - **グラフの動的リサイズ対応**: Force-Stroke グラフを PNG 画像表示から Matplotlib の `FigureCanvasQTAgg` 埋め込みに変更。ウィンドウサイズに自動追従。
    - **Loading Overlay の修正**: EXE 環境でローディング表示が正しく中央配置されない問題を修正。

---

## Version 1.2.1 (コンター表示の滑らか化)
**開発日**: 2026-01-06
応力・ひずみコンター図の表示品質を向上させたマイナーアップデートです。

- **改善機能:**
    - **コンター図の滑らか表示**: 応力・ひずみなどの要素データ (Cell Data) を節点データ (Point Data) に変換し、隣接要素間で滑らかなグラデーション表示を実現。変位と同様の視覚的品質を確保。

---

## Version 1.2.0 (Anti-sleep 機能とブランチ整理)
**開発開始日**: 2026-01-05
長時間の解析実行を支援する Anti-sleep 機能を追加し、開発ブランチを整理したバージョンです。

- **追加・改善機能:**
    - **Anti-sleep 機能**: ツールバーにトグルボタンを追加。有効化すると PC のスリープと画面 OFF を防止し、長時間のバッチ解析を中断なく実行可能に。`eye-solid` / `eye-closed` アイコンで状態を視覚化。
    - **ブランチ整理**: 古い開発ブランチ（AG-GUI, Anti-G, GPT-trial, SOLVER-INCLUDE）を削除し、WAFFLEIRON ブランチを main へマージ。

---

## Version 1.1.2 (Waffleiron 統合と .xplt 直接読み込み)
**開発開始日**: 2026-01-05
FEBio のネイティブ出力形式 `.xplt` を直接読み込む機能を追加し、結果表示のパフォーマンスと柔軟性を大幅に向上させたバージョンです。

- **追加・改善機能:**
    - **Waffleiron ライブラリの統合**: FEBio の `.xplt` バイナリ形式を直接解析し、PyVista メッシュに変換可能に。VTK 中間ファイルが不要となり、ロード時間を短縮。
    - **ResultViewer の全面リファクタリング**: 3D コンターと荷重-変位グラフをタブ切り替えで表示。フィールド選択ドロップダウンにより、displacement / stress / Lagrange strain を選択可能。
    - **テーマ設定の QSS 統合**: PyVista 3D ビューアの背景グラデーションや凡例カラーを `dark_theme.qss` から直接設定可能に。
    - **部分結果の表示対応**: スキップや停止されたジョブでも、.xplt ファイルが存在すれば途中経過を3Dで確認可能。
    - **ジョブ管理の安定性向上**: スキップ/停止操作時のシグナル競合を修正し、ステータス表示の正確性を改善。

## Version 1.1.0 (UX の洗練と堅牢性の向上)
**開発開始日**: 2026-01-02
GUI の操作性向上と、配布パッケージ（EXE）としての安定性を大幅に強化したバージョンです。

- **追加・改善機能:**
    - **SVGアイコン対応**: 高解像度（4K等）ディスプレイでも鮮明な表示を維持するベクター形式アイコンを採用。ダークモードに最適化された配色を動的に適用。
    - **高度なクラッシュハンドラー**: 実行時に予期せぬエラー（セグメンテーションフォールトやPython例外）が発生した際、スタックトレースをログに保存しつつ、ユーザーに致命的エラーを通知するダイアログを表示。
    - **自動ログローテーション機能**: 起動ごとに日時付きのログファイルを `logs/` ディレクトリに生成。トラブルシューティングのための詳細な実行履歴を保持。
    - **配布用ビルドの最適化**: PyInstaller によるビルドプロセスを刷新し、QtSvgプラグインや外部DLLの依存関係を完全に解消。

## Version 1.0.0 (GUI 搭載ファーストリリース)
**開発開始日**: 2025-12-28
VEXIS-CAE がコマンドラインツールから、直感的なデスクトップアプリケーションへと進化したメジャーアップデートです。

- **主要アップデート内容:**
    - **Modern GUI (PySide6)**: 洗練されたダークテーマを採用したインターフェース。
    - **インタラクティブ 3D ビューア**: 解析前の CAD 形状や生成されたメッシュ、解析後の変形図をマウス操作で自由に回転・拡大して確認可能。
    - **リアルタイム解析モニタリング**: ソルバーの出力ログをリアルタイムでストリーミング表示し、プログレスバーによる進捗の可視化を実現。
    - **インテリジェント・ジョブ監視**: `input/` フォルダを常時監視し、STEP ファイルを配置するだけで自動的に解析ジョブとしてリスト登録。

## Version 0.5.0 (CLI 最終安定版)
**開発開始日**: 2025-12-20
CLI ベースでの自動解析エンジンの完成形です。Proto シリーズで開発された全機能を統合し、プロダクションレベルの安定性を確保しました。

- **主要機能:**
    - 複数の STEP ファイルに対する完全自動バッチ処理。
    - YAML ベースの高度なコンフィギュレーション管理。
    - 解析結果の自動ポスト処理（荷重-変位 CSV 出力およびグラフ生成）。

## Version 0.4 (Proto 4: 高度なメッシュ生成と外部化)
**開発開始日**: 2025-12-10
メッシュ品質の向上と、異なる実行環境への柔軟な適応を実現したフェーズです。

- **詳細:**
    - **バタフライメッシュ生成アルゴリズム**: 円筒やドーム形状に対して、中心部に構造格子（正方形ブロック）を配置する O-Grid 技法を実装。特異点を排除し、ソルバーの収束性を劇的に向上。
    - **並列ソルバー制御**: `config.yaml` から CPU スレッド数を指定可能にし、大規模計算の高速化に対応。
    - **環境非依存のパス解決**: FEBio 本体の実行パスやテンプレート、材料ライブラリをすべて外部設定ファイルで定義可能にし、ポータビリティを向上。

## Version 0.3 (Proto 3: 動的設定エンジンの導入)
**開発開始日**: 2025-12-02
解析パラメータをソースコードから分離し、ユーザーが自由に変更できる基盤を構築したフェーズです。

- **詳細:**
    - **集中管理システム**: 押し込み条件、ステップ分割数、ソルバーの許容誤差などを `config.yaml` から動的に読み込む機能を実装。
    - **材料特性の外部化**: 材料パラメータを独立した設定として扱い、実験データに基づいた迅速な調整を可能に。
    - **エラーハンドリングの強化**: メッシュ生成失敗やソルバーの非収束時に、エラーメッセージを色分けして表示し、原因特定を容易化。

## Version 0.2 (Proto 2: 構造化とUXの初期設計)
**開発開始日**: 2025-11-20
単なるスクリプトの集まりから、一貫したアプリケーション構造へと整理されたフェーズです。

- **詳細:**
    - **ディレクトリ構造の定義**: `input`, `temp`, `results`, `settings` の役割を明確化し、自動クリーンアップ機能を実装。
    - **視覚的フィードバック**: `tqdm` ライブラリを導入し、コマンドライン上でのメッシュ生成やソルバー実行の進捗を視覚化。
    - **信号処理**: `Ctrl+C` による安全な解析中断と、中間ファイルの自動保存を実装。

## Version 0.1 (Proto 1: 自動化の概念実証)
**開発開始日**: 2025-11-10
CAD モデルから結果出力までを一気通貫で自動化できることを証明した、最初のプロトタイプです。

- **詳細:**
    - **Gmsh-FEBio パイプライン**: STEP ファイルを読み込み、背景で Gmsh を呼び出してメッシュを生成、さらに FEBio の XML 入力ファイルを自動生成して計算を開始する基本フローを構築。
    - **結果抽出エンジンの試作**: 解析完了後のバイナリ結果から必要な数値データ（力と Stroke）を抽出し、Matplotlib でグラフ化する工程を自動化。
