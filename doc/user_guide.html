<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>Proto4 ユーザーガイド & 機能説明</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
        }

        h1 {
            border-bottom: 2px solid #0052CC;
            color: #0052CC;
            padding-bottom: 10px;
        }

        h2 {
            border-bottom: 1px solid #DFE1E6;
            color: #172B4D;
            margin-top: 30px;
        }

        h3 {
            color: #253858;
            margin-top: 25px;
        }

        code {
            background: #F4F5F7;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 0.9em;
        }

        pre {
            background: #F4F5F7;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid #DFE1E6;
        }

        .info-box {
            background: #DEEBFF;
            border-left: 5px solid #0052CC;
            padding: 15px;
            margin: 20px 0;
        }

        .panel {
            border: 1px solid #DFE1E6;
            border-radius: 5px;
            margin: 20px 0;
        }

        .panel-header {
            background: #F4F5F7;
            padding: 10px 15px;
            font-weight: bold;
            border-bottom: 1px solid #DFE1E6;
        }

        .panel-body {
            padding: 15px;
        }

        ul {
            padding-left: 20px;
        }

        li {
            margin-bottom: 5px;
        }
    </style>
</head>

<body>

    <h1>Proto4 ユーザーガイド & 機能説明</h1>
    <p>Proto4 は、ゴム弾性体の座屈解析を全自動で実行するための高度な統合解析ワークフローです。</p>

    <h2>主要機能</h2>
    <ul>
        <li><b>高度なメッシュ生成 (Adaptive O-Grid):</b> バタフライメッシュアルゴリズムを採用し、中心部の要素品質を最適化。</li>
        <li><b>FEBio 統合:</b> メッシュ生成からFEBio入力ファイルの作成、計算実行、結果抽出までをシームレスに処理。</li>
        <li><b>柔軟なコンフィギュレーション:</b> すべての設定を単一の <code>config.yaml</code> で管理。</li>
        <li><b>スレッド制御:</b> ソルバーが使用するCPUスレッド数を制御し、バックグラウンド実行時の負荷を調整可能。</li>
    </ul>

    <h2>使い方</h2>

    <h3>1. 準備</h3>
    <p><code>Proto4/input</code> フォルダに以下のファイルを配置します。</p>
    <ul>
        <li><code>*.stp</code> または <code>*.step</code> : 解析対象の形状ファイル。</li>
        <li><code>config.yaml</code> : メッシュ・解析設定。</li>
        <li><code>material.yaml</code> : 材料定数の定義。</li>
    </ul>

    <h3>2. 設定 (<code>config.yaml</code>)</h3>
    <p>主要な設定項目は以下の通りです。</p>
    <pre><code>mesh:
  mesh_size: 0.3         # 要素サイズ
  revolve_layers: 14     # 周方向の分割数
  mesh_dimension: 2      # 次数 (1: 線形, 2: 2次要素)

analysis:
  febio_path: "..."      # FEBio実行ファイルの絶対パス
  template_feb: "..."    # ベースとなる.febテンプレート名
  total_stroke: 1.0      # 押し込み量(mm)
  num_threads: 4         # 使用スレッド数</code></pre>

    <h3>3. 実行</h3>
    <p>PowerShell等の端末で <code>Proto4</code> ディレクトリに移動し、以下のコマンドを実行します。</p>
    <pre><code>python main.py</code></pre>

    <p><b>オプション:</b></p>
    <ul>
        <li><code>--mesh-only</code>: メッシュ生成のみを行い、解析は実行しません。</li>
        <li><code>--skip-mesh</code>: 既存のメッシュ（<code>temp/</code>内）を使用して解析のみを実行します。</li>
    </ul>

    <div class="info-box">
        <strong>バタフライメッシュについて:</strong><br>
        円形断面のメッシュ生成において、中心点での要素の集中（特異点）を避けるために中心を四角形のブロックで構成しています。これにより、大変形を伴う座屈解析においても高い収束性と精度を維持できます。
    </div>

    <div class="panel">
        <div class="panel-header">トラブルシューティング</div>
        <div class="panel-body">
            解析が正常に動作しない場合は、<code>temp/workflow_detailed.log</code> および <code>results/</code> 内の各ログファイルを確認してください。
        </div>
    </div>

</body>

</html>